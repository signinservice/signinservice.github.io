import{b as h}from"./chunk-EXUDQ43K.js";import{a as S}from"./chunk-GQZ4J7UJ.js";import{A as o,D as T}from"./chunk-E5M5ZXR5.js";import{f as P,i as n}from"./chunk-E2I6K3L7.js";var I=P(S());var g=(()=>{let e=class e{static get PREF_INITIALIZED(){return"preferencesInitialized"}static get PREF_SHOW_ITEMS_AROUND(){return"pref_show_items_around"}static get PREF_REFRESH_INTERVAL(){return"pref_refresh_interval"}static get PREF_USER_POSITION_RADIUS(){return"pref_user_position_radius"}static get PREF_HIGHLIGHT_TAGS_WITH_TEXT(){return"pref_highlight_tags_with_text"}constructor(t){this.storage=t,this.preferences={},this.preferenceKeys=[e.PREF_SHOW_ITEMS_AROUND,e.PREF_REFRESH_INTERVAL,e.PREF_USER_POSITION_RADIUS,e.PREF_HIGHLIGHT_TAGS_WITH_TEXT],this.initializePreferences()}initializePreferences(){return n(this,null,function*(){this.preferences[e.PREF_SHOW_ITEMS_AROUND]=0,this.preferences[e.PREF_REFRESH_INTERVAL]=5,this.preferences[e.PREF_USER_POSITION_RADIUS]=5,this.preferences[e.PREF_HIGHLIGHT_TAGS_WITH_TEXT]="",yield this.loadPreferenceFromDatabase()})}loadPreferenceFromDatabase(){return n(this,null,function*(){var r,s,i,a,c,E;(yield(r=this.storage)==null?void 0:r.get(e.PREF_INITIALIZED))?I.each(this.preferenceKeys,R=>n(this,null,function*(){var f;try{this.preferences[R]=yield(f=this.storage)==null?void 0:f.get(R)}catch{}})):((s=this.storage)==null||s.set(e.PREF_INITIALIZED,!0),(i=this.storage)==null||i.set(e.PREF_SHOW_ITEMS_AROUND,this.preferences[e.PREF_SHOW_ITEMS_AROUND]),(a=this.storage)==null||a.set(e.PREF_REFRESH_INTERVAL,this.preferences[e.PREF_REFRESH_INTERVAL]),(c=this.storage)==null||c.set(e.PREF_USER_POSITION_RADIUS,this.preferences[e.PREF_USER_POSITION_RADIUS]),(E=this.storage)==null||E.set(e.PREF_HIGHLIGHT_TAGS_WITH_TEXT,this.preferences[e.PREF_HIGHLIGHT_TAGS_WITH_TEXT]))})}getPreference(t){return this.preferences[t]}setPreference(t,r){return n(this,null,function*(){var s;this.preferences[t]=r,yield(s=this.storage)==null?void 0:s.set(t,r)})}savePreference(t){return n(this,null,function*(){var r;if(I.isObject(t))for(let s=0;s<this.preferenceKeys.length;s++){let i=this.preferenceKeys[s],a=t[i];this.preferences[i]=a,yield(r=this.storage)==null?void 0:r.set(i,a)}})}_getAllPreferences(t){return Promise.all(t.map(r=>{var s;return(s=this.storage)==null?void 0:s.get(r)}))}_getPreference(t){var r;return(r=this.storage)==null?void 0:r.get(t)}};e.\u0275fac=function(r){return new(r||e)(T(h))},e.\u0275prov=o({token:e,factory:e.\u0275fac,providedIn:"root"});let _=e;return _})();export{g as a};
