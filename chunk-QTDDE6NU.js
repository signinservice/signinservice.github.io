import{a as W,b as Ee,i as Me,j as Y,k as Ve,n as Oe,s as Le,w as Z}from"./chunk-2GMLSDXM.js";import{a as re}from"./chunk-DYMM3L2N.js";import{a as ee}from"./chunk-64N5HP7E.js";import{f as b}from"./chunk-3O2XMPDP.js";import{a as Ne,c as De,d as Pe,e as Ae}from"./chunk-UIG37U42.js";import{a as Re}from"./chunk-GQZ4J7UJ.js";import{$a as V,Aa as U,Ab as Fe,Ba as ie,Bb as Se,Ca as T,Da as y,E as C,Ea as x,Eb as ve,Fa as j,Fb as R,G as w,Ga as k,Gb as N,Ha as me,Ja as ue,La as de,Lc as J,Ma as _e,Mc as we,N as _,Nc as Te,O as g,Oc as ye,Pc as xe,Qc as ke,Wa as E,Xa as M,Z as c,_a as ge,ba as F,bc as Ie,da as m,ea as le,gc as D,hc as be,ic as q,ja as n,jc as z,ka as r,kc as P,la as S,lc as K,mb as fe,na as h,oa as d,pa as f,pc as A,tc as B,ua as ae,uc as Q,va as se,vb as O,wa as ce,wb as he,xa as pe,xb as ne,ya as s,yb as L,yc as X,za as $,zb as Ce}from"./chunk-E5M5ZXR5.js";import{f as oe,i as v}from"./chunk-E2I6K3L7.js";var G=oe(Re());var H=oe(Re());var He=()=>({standalone:!0});function $e(o,l){if(o&1){let a=h();n(0,"ion-item",18),d("click",function(){let e=_(a).$implicit,i=f(2);return g(i.addTag(e))}),s(1),r()}if(o&2){let a=l.$implicit;c(),U(" ",a," ")}}function Ue(o,l){if(o&1&&(n(0,"ion-list"),F(1,$e,2,1,"ion-item",17),r()),o&2){let a=f();c(),m("ngForOf",a.filteredTags)}}function je(o,l){if(o&1){let a=h();n(0,"ion-chip")(1,"ion-label"),s(2),r(),n(3,"ion-icon",19),d("click",function(){let e=_(a).$implicit,i=f();return g(i.removeTag(e))}),r()()}if(o&2){let a=l.$implicit;c(2),$(a)}}var te=(()=>{let l=class l{constructor(){this.fb=C(ve),this.utilService=C(Ne),this.appService=C(ee),this.modalCtrl=C(b),this.availableTags=["electronics","clothing","books","home","sports","kitchen","toys","beauty"],this.filteredTags=[...this.availableTags],this.tagInput="",this.showAutocomplete=!1,this.filterForm=this.fb.group({id:[""],searchQuery:[""],priceRange:[{lower:0,upper:1e3}],discountRange:[{lower:0,upper:100}],filterTags:this.fb.array([]),name:[""]}),W({closeCircle:Y,trashOutline:Z})}ngOnInit(){this.availableTags.forEach(()=>this.tags.push(new ne(!1)))}ionViewDidEnter(){console.log("Modal has been presented",this.data),H.isNil(this.data)||(this.filterForm.patchValue(this.data),this.filterForm.patchValue(this.data.criteria))}get tags(){return this.filterForm.get("filterTags")}filterTags(t){this.tagInput=t.target.value.toLowerCase(),this.filteredTags=this.tagInput?this.availableTags.filter(e=>e.toLowerCase().includes(this.tagInput)):[...this.availableTags],this.showAutocomplete=!!this.tagInput&&this.filteredTags.length>0}addTag(t){if(t&&!this.selectedTags.includes(t)){let e=this.availableTags.indexOf(t);e>=0?this.tags.at(e).setValue(!0):(this.availableTags.push(t),this.tags.push(new ne(!0))),this.tagInput="",this.filteredTags=[...this.availableTags],this.showAutocomplete=!1}}removeTag(t){let e=this.availableTags.indexOf(t);e>=0&&this.tags.at(e).setValue(!1)}get selectedTags(){return this.availableTags.filter((t,e)=>this.tags.at(e).value)}saveFilter(){return v(this,null,function*(){var e,i,p,u,I;let t={id:(e=this.filterForm.get("id"))==null?void 0:e.value,name:(i=this.filterForm.get("name"))==null?void 0:i.value,criteria:{searchQuery:(p=this.filterForm.get("searchQuery"))==null?void 0:p.value,priceRange:(u=this.filterForm.get("priceRange"))==null?void 0:u.value,discountRange:(I=this.filterForm.get("discountRange"))==null?void 0:I.value,filterTags:this.selectedTags}};(H.isNil(t.id)||H.isEmpty(t.id))&&(t.id=this.utilService.makeUniqueId()),yield this.appService.saveFilter(t),yield this.appService.successToast(`Filter "${t.name}" saved`),this.dismiss(t)})}clearFilters(){this.filterForm.reset({searchQuery:"",priceRange:{lower:0,upper:1e3},discountRange:{lower:0,upper:100},name:"",filterTags:[]}),this.filterForm.setControl("tags",this.fb.array(this.availableTags.map(()=>!1))),this.tagInput="",this.filteredTags=[...this.availableTags],this.showAutocomplete=!1}onTagInputKeypress(t){t.key==="Enter"&&this.tagInput&&(t.preventDefault(),this.addTag(this.tagInput.trim()))}dismiss(t){this.modalCtrl.dismiss({data:t})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=w({type:l,selectors:[["app-filter"]],inputs:{data:"data"},standalone:!0,features:[k],decls:45,vars:10,consts:[[1,"ion-padding"],[3,"formGroup"],["position","stacked"],["formControlName","name","placeholder","Enter filter name","aria-label","Filter name"],["formControlName","searchQuery","placeholder","Search text"],["dual-knobs","true","formControlName","priceRange","min","0","max","1000","step","10","pin","true"],["slot","start"],["slot","end"],["dual-knobs","true","formControlName","discountRange","min","0","max","100","step","5","pin","true"],["position","floating"],["placeholder","Type to search or add...","clearInput","",3,"ngModelChange","ionInput","keydown.enter","ngModel","ngModelOptions"],[4,"ngIf"],[2,"margin-top","10px"],[4,"ngFor","ngForOf"],["size","6"],["expand","block","color","primary",3,"click"],["expand","block","color","tertiary",3,"click"],["button","",3,"click",4,"ngFor","ngForOf"],["button","",3,"click"],["name","close-circle","color","danger",3,"click"]],template:function(e,i){if(e&1&&(n(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s(3,"Filters"),r()()(),n(4,"ion-content",0)(5,"form",1)(6,"ion-item")(7,"ion-label",2),s(8,"Filter Name"),r(),S(9,"ion-input",3),r(),n(10,"ion-item")(11,"ion-label",2),s(12,"Search"),r(),S(13,"ion-input",4),r(),n(14,"ion-item")(15,"ion-label",2),s(16),r(),n(17,"ion-range",5)(18,"ion-label",6),s(19,"$0"),r(),n(20,"ion-label",7),s(21,"$1000"),r()()(),n(22,"ion-item")(23,"ion-label",2),s(24),r(),n(25,"ion-range",8)(26,"ion-label",6),s(27,"0%"),r(),n(28,"ion-label",7),s(29,"100%"),r()()(),n(30,"ion-item")(31,"ion-label",9),s(32,"Add Tags"),r(),n(33,"ion-input",10),x("ngModelChange",function(u){return y(i.tagInput,u)||(i.tagInput=u),u}),d("ionInput",function(u){return i.filterTags(u)})("keydown.enter",function(){return i.addTag(i.tagInput)}),r()(),F(34,Ue,2,1,"ion-list",11),n(35,"div",12),F(36,je,4,1,"ion-chip",13),r(),n(37,"ion-grid")(38,"ion-row")(39,"ion-col",14)(40,"ion-button",15),d("click",function(){return i.saveFilter()}),s(41," Save & Apply "),r()(),n(42,"ion-col",14)(43,"ion-button",16),d("click",function(){return i.dismiss(null)}),s(44," Cancel "),r()()()()()()),e&2){let p,u;c(5),m("formGroup",i.filterForm),c(11),ie("Price Range - $",(p=i.filterForm.get("priceRange"))==null||p.value==null?null:p.value.lower," - $",(p=i.filterForm.get("priceRange"))==null||p.value==null?null:p.value.upper,""),c(8),ie("Discount Range (%) - ",(u=i.filterForm.get("discountRange"))==null||u.value==null?null:u.value.lower,"% - ",(u=i.filterForm.get("discountRange"))==null||u.value==null?null:u.value.upper,"% "),c(9),T("ngModel",i.tagInput),m("ngModelOptions",me(9,He)),c(),m("ngIf",i.filteredTags.length&&i.tagInput),c(2),m("ngForOf",i.selectedTags)}},dependencies:[J,D,q,P,xe,Q,A,B,we,K,X,z,V,E,M,N,Ce,O,he,Fe,Se,R,L]});let o=l;return o})();function qe(o,l){if(o&1&&(n(0,"ion-item"),S(1,"ion-radio",10),n(2,"ion-label"),s(3),r()()),o&2){let a=l.$implicit;c(),m("value",a.id),c(2),U(" ",a.name,"")}}function ze(o,l){if(o&1){let a=h();n(0,"ion-list")(1,"ion-radio-group",8),x("ngModelChange",function(e){_(a);let i=f();return y(i.selectedFilter,e)||(i.selectedFilter=e),g(e)}),F(2,qe,4,2,"ion-item",9),r()()}if(o&2){let a=f();c(),T("ngModel",a.selectedFilter),c(),m("ngForOf",a.filterList)}}function Ke(o,l){o&1&&(n(0,"ion-item",11)(1,"ion-label"),s(2,"No filters available."),r()())}function Xe(o,l){if(o&1){let a=h();n(0,"ion-button",12),d("click",function(){_(a);let e=f();return g(e.applyFilter(e.selectedFilter))}),s(1," Apply "),r()}}function Je(o,l){if(o&1){let a=h();n(0,"ion-button",13),d("click",function(){_(a);let e=f();return g(e.editFilter(e.selectedFilter))}),s(1," Edit "),r()}}function Ye(o,l){if(o&1){let a=h();n(0,"ion-button",14),d("click",function(){_(a);let e=f();return g(e.deleteFilter(e.selectedFilter))}),s(1," Delete "),r()}}var Ge=(()=>{let l=class l{constructor(){this.filterList=[],this.appService=C(ee),this.modalCtrl=C(b),this.newFilterName="",W({closeCircle:Y,trashOutline:Z})}ionViewDidEnter(){return v(this,null,function*(){yield this.loadData()})}ngOnInit(){}loadData(){return v(this,null,function*(){this.selectedFilter=null,this.filterList=yield this.appService.getFilters()})}applyFilter(t){}deleteFilter(t){return v(this,null,function*(){yield this.appService.deleteFilter(t),yield this.loadData()})}editFilter(t){return v(this,null,function*(){this.dismiss(null);let e=yield this.appService.getFilterById(t);yield(yield this.modalCtrl.create({component:te,componentProps:{data:e}})).present()})}dismiss(t){this.modalCtrl.dismiss({data:t})}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=w({type:l,selectors:[["filter-list"]],standalone:!0,features:[j([b]),k],decls:19,vars:5,consts:[["noFilters",""],[1,"ion-padding"],[4,"ngIf","ngIfElse"],["size","3"],["expand","block","color","primary",3,"click",4,"ngIf"],["expand","block","color","medium",3,"click",4,"ngIf"],["expand","block","color","dark",3,"click",4,"ngIf"],["expand","block","color","tertiary",3,"click"],[3,"ngModelChange","ngModel"],[4,"ngFor","ngForOf"],["slot","start",3,"value"],["lines","none"],["expand","block","color","primary",3,"click"],["expand","block","color","medium",3,"click"],["expand","block","color","dark",3,"click"]],template:function(e,i){if(e&1){let p=h();n(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s(3,"Saved Filters"),r()()(),n(4,"ion-content",1),F(5,ze,3,2,"ion-list",2)(6,Ke,3,0,"ng-template",null,0,_e),n(8,"ion-grid")(9,"ion-row")(10,"ion-col",3),F(11,Xe,2,0,"ion-button",4),r(),n(12,"ion-col",3),F(13,Je,2,0,"ion-button",5),r(),n(14,"ion-col",3),F(15,Ye,2,0,"ion-button",6),r(),n(16,"ion-col",3)(17,"ion-button",7),d("click",function(){return _(p),g(i.dismiss(null))}),s(18," Cancel "),r()()()()()}if(e&2){let p=pe(7);c(5),m("ngIf",i.filterList&&i.filterList.length>0)("ngIfElse",p),c(6),m("ngIf",i.selectedFilter),c(2),m("ngIf",i.selectedFilter),c(2),m("ngIf",i.selectedFilter)}},dependencies:[D,P,Q,A,B,ye,Te,K,X,z,V,E,M,N,O,R,L]});let o=l;return o})();var Ze=["popover"];function et(o,l){if(o&1){let a=h();n(0,"ion-content")(1,"ion-list",10)(2,"ion-item",11),d("click",function(){_(a);let e=f();return g(e.createFilter())}),S(3,"ion-icon",12),n(4,"ion-label"),s(5,"Create Filter"),r()(),n(6,"ion-item",11),d("click",function(){_(a);let e=f();return g(e.applyFilter())}),S(7,"ion-icon",13),n(8,"ion-label"),s(9,"Apply Filter"),r()(),n(10,"ion-item",11),d("click",function(){_(a);let e=f();return g(e.sortByPrice())}),S(11,"ion-icon",14),n(12,"ion-label"),s(13,"Sort by Price"),r()()()()}}function tt(o,l){if(o&1){let a=h();n(0,"ion-chip",15),d("click",function(){_(a);let e=f();return g(e.clearFilters())}),S(1,"ion-icon",16),n(2,"ion-label"),s(3,"Clear"),r()()}}function it(o,l){if(o&1){let a=h();n(0,"ion-chip",17),d("click",function(){let e=_(a).$implicit,i=f();return g(i.selectFilterTag(e))}),n(1,"ion-label"),s(2),r()()}if(o&2){let a=l.$implicit,t=f();le("blink-border",t.doesMatchHighlightTag(a)),m("outline",t.isFilterTagSelected(a))("color",t.isFilterTagSelected(a)?"primary":""),c(2),$(a)}}var ti=(()=>{let l=class l{constructor(){this.apiService=C(Ae),this.preferenceService=C(re),this.modalCtrl=C(b),this.router=C(fe),this.searchCriteria=new De,this.searchSupportData=new Pe,this.menuTriggerId="menu-trigger-"+Date.now(),W({close:Me,ellipsisVertical:Ve,addCircleOutline:Ee,funnelOutline:Oe,pricetagOutline:Le})}onSearch(t){this.apiService.setSearchCriteria(this.searchCriteria)}doesMatchHighlightTag(t){let e=this.preferenceService.getPreference(re.PREF_HIGHLIGHT_TAGS_WITH_TEXT),i=!1;return G.isNil(e)||(i=e.indexOf(t.toLowerCase())>-1),i}selectFilterTag(t){G.includes(this.searchCriteria.filterTags,t)?G.remove(this.searchCriteria.filterTags,e=>e==t):this.searchCriteria.filterTags.push(t),this.onSearch(null)}isFilterTagSelected(t){return this.searchCriteria.filterTags.indexOf(t)!==-1}clearFilters(){this.searchCriteria.filterTags=[],this.onSearch(null)}ngOnInit(){this.searchCriteriaSubscription=this.apiService.searchCriteria$.subscribe(t=>{this.searchCriteria=t}),this.searchSupportDataSubscription=this.apiService.searchSupportData$.subscribe(t=>{this.searchSupportData=t})}ngOnDestroy(){this.searchCriteriaSubscription.unsubscribe(),this.searchSupportDataSubscription.unsubscribe()}createFilter(){return v(this,null,function*(){this.popover.dismiss();let t=yield this.modalCtrl.create({component:te});yield t.present();let{data:e}=yield t.onWillDismiss();e&&console.log("Applying Saved Filter:",e)})}applyFilter(){return v(this,null,function*(){this.popover.dismiss();let t=yield this.modalCtrl.create({component:Ge});yield t.present();let{data:e}=yield t.onWillDismiss();e&&console.log("Applying Filter",e)})}sortByPrice(){console.log("Sort by price clicked")}openFilter(){this.router.navigate(["/filter"])}};l.\u0275fac=function(e){return new(e||l)},l.\u0275cmp=w({type:l,selectors:[["search-filter"]],viewQuery:function(e,i){if(e&1&&ae(Ze,5),e&2){let p;se(p=ce())&&(i.popover=p.first)}},standalone:!0,features:[j([b]),k],decls:12,vars:10,consts:[["popover",""],[1,"searchbar-with-button"],[3,"ngModelChange","ionInput","debounce","ngModel"],["slot","end"],[3,"id"],["slot","icon-only","name","ellipsis-vertical"],["triggerAction","click",3,"trigger"],[1,"chip-scroll-container"],["outline","","color","danger",3,"click",4,"ngIf"],[3,"outline","blink-border","color","click",4,"ngFor","ngForOf"],["lines","none"],["button","",3,"click"],["color","primary","name","add-circle-outline","slot","start"],["color","primary","name","funnel-outline","slot","start"],["color","primary","name","pricetag-outline","slot","start"],["outline","","color","danger",3,"click"],["name","close","slot","start"],[3,"click","outline","color"]],template:function(e,i){if(e&1){let p=h();n(0,"div",1)(1,"ion-searchbar",2),x("ngModelChange",function(I){return _(p),y(i.searchCriteria.searchQuery,I)||(i.searchCriteria.searchQuery=I),g(I)}),d("ionInput",function(I){return _(p),g(i.onSearch(I))}),r(),n(2,"ion-buttons",3)(3,"ion-button",4),S(4,"ion-icon",5),r()()(),n(5,"ion-popover",6,0),F(7,et,14,0,"ng-template"),r(),n(8,"div",7),F(9,tt,4,0,"ion-chip",8)(10,it,3,5,"ion-chip",9),ue(11,"slice"),r()}e&2&&(c(),m("debounce",2e3),T("ngModel",i.searchCriteria.searchQuery),c(2),m("id",i.menuTriggerId),c(2),m("trigger",i.menuTriggerId),c(4),m("ngIf",i.searchCriteria.filterTags.length>0),c(),m("ngForOf",de(11,6,i.searchSupportData.filterTags,0,15)))},dependencies:[ke,J,D,q,be,Ie,P,Q,A,B,V,E,M,ge,R,O,L,N],styles:[".searchbar-with-button[_ngcontent-%COMP%]{padding-top:8px;display:flex;align-items:stretch}ion-searchbar[_ngcontent-%COMP%]{flex:1}.chip-scroll-container[_ngcontent-%COMP%]{display:flex;overflow-x:auto;-webkit-overflow-scrolling:touch;scroll-snap-type:x mandatory}.chip-scroll-container[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{scroll-snap-align:start;flex-shrink:0}"]});let o=l;return o})();export{ti as a};
